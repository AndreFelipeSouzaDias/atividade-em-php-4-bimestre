<?php

function calcularSono($horaDormir, $horaAcordar, $sonoIdeal = 8) {
    $inicio = strtotime($horaDormir);
    $fim = strtotime($horaAcordar);

    if ($fim <= $inicio) {
        $fim = strtotime($horaAcordar . " +1 day");
    }

    $minutosSono = ($fim - $inicio) / 60;
    $horasSono = floor($minutosSono / 60);
    $minutosRestantes = $minutosSono % 60;
    $ciclos = floor($minutosSono / 90);

    if ($minutosSono < 240) {
        $nivel = "â˜ ï¸ NÃ­vel Zumbi â€” Vai precisar de muito cafÃ©! â˜ ï¸";
    } elseif ($minutosSono < 360) {
        $nivel = "Sono curto â€” Vai acordar meio grogue...";
    } elseif ($minutosSono < 480) {
        $nivel = "Sono bom â€” Quase no ponto ideal!";
    } else {
        $nivel = "Mestre dos Sonhos â€” Sono perfeito!";
    }

    $mensagem = sprintf(
        "\nVocÃª vai dormir por %dh %02dmin, completando %d ciclos de sono.\n%s\n",
        $horasSono,
        $minutosRestantes,
        $ciclos,
        $nivel
    );

    return $mensagem;
}

echo "=============================\n";
echo "        ðŸ’¤ DORMILÃ”METRO       \n";
echo "=============================\n\n";

echo "Que horas vocÃª vai dormir? (formato 24h, ex: 23:30): ";
$horaDormir = trim(fgets(STDIN));

echo "Que horas vocÃª vai acordar? (formato 24h, ex: 07:00): ";
$horaAcordar = trim(fgets(STDIN));

echo "Quantas horas de sono ideal vocÃª gostaria? (padrÃ£o 8h): ";
$sonoIdeal = trim(fgets(STDIN));
if ($sonoIdeal === "" || !is_numeric($sonoIdeal)) {
    $sonoIdeal = 8;
}

$resultado = calcularSono($horaDormir, $horaAcordar, $sonoIdeal);

echo "\n--------------------------------------\n";
echo $resultado;
echo "--------------------------------------\n";
?>
